[General]
# Path Loss example:
# This example shows how to use ESTNeT with its model for the atmospheric pathloss
# The scenario simulates a satellite, that shall transmit data whenever 
# it is generated by the app. The transmissions are in the X band.
# The application in the satellite is generating 30 packets.
# In the basic configuration, only Free Space Path Loss is used, while in the
# other configuration, the atmospheric model is added.


# NETWORK AND SIMULATION CONFIGURATION
network = estnet.SpaceTerrestrialNetwork
sim-time-limit = 600s

# start time as julian date
*.globalJulianDate.simulationStart = "2020-03-11T10:58:00.00+01:00Z"

# SATELLITE ORBIT
*.numS = 1 # number of satellites
*.sat[*].label = "Satellite"
*.sat[*].networkHost.mobility.positionPropagator.a = (6371km + 700km)
*.sat[*].networkHost.mobility.positionPropagator.e = 0
*.sat[*].networkHost.mobility.positionPropagator.i = 80deg
*.sat[*].networkHost.mobility.positionPropagator.raan = 320deg
*.sat[*].networkHost.mobility.positionPropagator.aop = 0
*.sat[0].networkHost.mobility.positionPropagator.v = 30deg


# GROUND STATION
*.numCg = 1     # number of ground stations
*.cg[0].networkHost.mobility.lat = 49.786844deg
*.cg[0].networkHost.mobility.lon = 9.980713deg
*.cg[0].networkHost.mobility.alt = 200m
*.cg[0].label = "Wuerzburg, Germany"


# VISUALIZATION
*.sat[*].osgNode.modelURL = "../../data/UWEModel.STL.500.scale.0,-90,0.rot"
*.cg[*].osgNode.modelURL = "../../data/UWEModel.STL.0,90,0.rot"
*.osgEarthScene.sceneModel = "../../data/blueMarble.earth"


# MEDIUM, RADIO AND BITRATE
*.mediumType = "inet.physicallayer.apskradio.packetlevel.ApskScalarRadioMedium"
*.radioMedium.propagation.typename = "estnet.radio.propagation.ConstantSpeedPropagationWithMovement"
*.radioMedium.analogModel.typename = "ScalarAnalogModel"
*.radioMedium.obstacleLoss.typename = "IdealObstacleLoss"

*.radioMedium.backgroundNoise.power = -134dBm # noise floor at 0deg, 10khz bw
*.radioMedium.mediumLimitCache.maxTransmissionDuration = 300ms
*.physicalEnvironment.config = xmldoc("../../data/earthObstacle.xml")

*.*.networkHost.wlan[*].radioType = "estnet.radio.apsk.APSKScalarRadioExtraStatistics"
*.*.networkHost.wlan[*].radio.transmitter.typename = "estnet.radio.psk8.APSKScalarTransmitterWith8PSK"
*.*.networkHost.wlan[*].radio.receiver.typename = "estnet.radio.psk8.APSKScalarReceiverWith8PSK"
*.*.networkHost.wlan[*].radio.centerFrequency = 8228MHz
*.*.networkHost.wlan[*].radio.bandwidth = 120kHz	# 120kHz for S-Net
*.*.networkHost.wlan[*].radio.transmitter.preambleDuration = 0s
*.*.networkHost.wlan[*].radio.transmitter.headerLength = 1B #TODO: search realistic value
*.*.networkHost.wlan[*].radio.*.modulation = "8PSK"

*.*.networkHost.wlan[*].radio.receiver.errorModel.typename = "estnet.radio.errormodel.PerfectErrorModel"

*.sat[*].networkHost.wlan[*].radio.transmitter.power = 0.55W
*.sat[*].networkHost.wlan[*].radio.receiver.energyDetection = -143.49dBm	# noise floor at reference temp 2.7K and 120 kHz bandwidth
*.sat[*].networkHost.wlan[*].radio.receiver.sensitivity = -143.49dBm	# noise floor at reference temp 2.7K and 120 kHz bandwidth

*.cg[*].networkHost.wlan[*].radio.transmitter.power = 50W
*.cg[*].networkHost.wlan[*].radio.receiver.energyDetection = -132.39dBm		# noise floor at reference temp 290 K and 14.4 kHz bandwidth
*.cg[*].networkHost.wlan[*].radio.receiver.sensitivity = -132.39dBm		# noise floor at reference temp 290 K and 14.4 kHz bandwidth

*.*.networkHost.wlan[*].radio.receiver.snirThreshold = 19.93 dB		# EbNo=12.97dB for 8-PSK BER=10^-5
*.*.networkHost.wlan[*].bitrate = 240000bps

# ANTENNA
*.sat[*].networkHost.wlan[*].radio.antenna.typename = "IsotropicAntenna"

*.cg[*].networkHost.wlan[*].radio.antenna.typename = "ParabolicAntenna"
*.cg[*].networkHost.wlan[*].radio.antenna.minGain = 0dB

*.cg[*].networkHost.wlan[*].radio.antenna.maxGain = 33dB
*.cg[*].networkHost.wlan[*].radio.antenna.beamWidth = 3deg
*.*.networkHost.wlan[*].radio.antenna.mobilityModule = "^.^.^.mobility"


# TRACKING
*.sat[*].attitudeController.target = "EARTH_CENTER"
*.cg[*].trackingType = "estnet.node.tracking.target.TargetTracking"
*.cg[*].nodeTracking.target = "1"


# PROTOCOL
*.*.hostType = "estnet.protocol.simpleprotocol.SimpleProtocolNode"
*.*.networkHost.wlan[*].macType = "estnet.mac.ideal.IdealMacExtraStatistics"
*.*.networkHost.wlan[*].mac.ackTimeout = 300ms


# APPLICATION LAYER: DATA GENERATION
*.sat[0].networkHost.appWrapper[0].appType = "BasicApp"
*.sat[0].networkHost.appWrapper[0].app.sending = true
*.sat[0].networkHost.appWrapper[0].app.startTime = 140s
*.sat[0].networkHost.appWrapper[0].app.stopTime = 450s
*.sat[0].networkHost.appWrapper[0].app.sendInterval = 10s
*.sat[0].networkHost.appWrapper[0].app.destinationNodes = "2"

[Config AtmosphericModel]

*.radioMedium.pathLoss.typename = "estnet.physicallayer.pathloss.AtmosphericPathLoss"

*.radioMedium.pathLoss.weatherModel.rainIntensity = 5 # mm / h
*.radioMedium.pathLoss.weatherModel.rainParameterFile = "../../data/a_b_raindrop_attenuation.csv"
*.radioMedium.pathLoss.weatherModel.rainDropDistribution = "MP"
